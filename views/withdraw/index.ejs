<style>
  .is-invalid {
    border-color: red !important;
  }

  .account-item.selected {
    border: 2px solid #28a745;
    background-color: #f0fff5;
    border-radius: 10px;
  }
</style>

<div class="appHeader">
  <div class="left">
    <a href="/" class="headerButton goBack">
      <ion-icon name="chevron-back-outline"></ion-icon>
    </a>
  </div>
  <div class="pageTitle">Withdraw</div>
  <div class="right">
    <a href="app-notifications.html" class="headerButton">
      <ion-icon name="notifications-outline"></ion-icon>
      <span class="badge badge-danger">4</span>
    </a>
  </div>
</div>

<div id="appCapsule">
  <!-- Step 1: Amount + Account -->
  <div id="tab-amount" style="display: block;">
    <div class="section d-flex align-items-center flex-column mt-4 mb-4 mx-4">
      <h3 class="d-flex justify-content-between align-items-center">Amount</h3>
      <div class="form-group boxed mb-2">
        <div class="input-wrapper">
          <input type="text" class="form-control" id="amount-input" placeholder="Min ₹ 500">
          <i class="clear-input"><ion-icon name="close-circle"></ion-icon></i>
        </div>
      </div>
      <p class="text-success">₹ 50,000</p>
      <p style="margin-top: -1rem;">Available Balance</p>
      
    </div>

    <div class="section my-4 mx-4">
      <h3 class="d-flex justify-content-between align-items-center">
        Account
        <button type="button" class="btn btn-link"><ion-icon name="add"></ion-icon> Add</button>
      </h3>
      <p class="mb-2">Select account to withdraw money.</p>

      <ul class="listview image-listview rounded mb-3">
        <li>
          <a href="#" class="item account-item">
            <img src="assets/img/sample/avatar/avatar1.jpg" alt="image" class="image">
            <div class="in">
              <div>
                Kotak Bank
                <footer>**** **** **** 9807</footer>
              </div>
            </div>
          </a>
        </li>
      </ul>  
      <ul class="listview image-listview rounded mb-3">
        <li>
          <a href="#" class="item account-item">
            <img src="assets/img/sample/avatar/avatar1.jpg" alt="image" class="image">
            <div class="in">
              <div>
                HDFC Bank
                <footer>**** **** **** 1234</footer>
              </div>
            </div>
          </a>
        </li>
      </ul>
    </div>
  </div>

  <!-- Step 2: OTP -->
  <div id="tab-otp" style="display: none;">
    <div class="section my-4 mx-4">
      <h3>OTP</h3>
      <p>Enter your 6-digit OTP.</p>
      <div class="form-group basic">
        <input type="text" class="form-control" id="otp-input" placeholder="123456">
        <i class="clear-input"><ion-icon name="close-circle"></ion-icon></i>
      </div>
    </div>

    <div class="section mx-2">
      <button type="button" id="confirm-otp" class="btn btn-primary w-100" disabled>Confirm</button>
    </div>
  </div>

  <!-- Step 3: Success -->
  <div id="tab-success" style="display: none;">
    <div class="section my-4 mx-4">
      <h3>Success</h3>
      <p>Your money has been withdrawn successfully.</p>
      <div class="text-center py-4">
        <img src="https://static-00.iconduck.com/assets.00/success-icon-512x512-qdg1isa0.png" style="width: 100px;">
      </div>
    </div>

    <div class="section mx-2 d-flex justify-content-between">
      <a href="/" class="w-50 me-1">
        <button type="button" class="btn btn-outline-secondary w-100">Home</button>
      </a>
      <a href="/trade" class="w-50 ms-1">
        <button type="button" class="btn btn-primary w-100">Trade</button>
      </a>
    </div>
  </div>
</div>

<script>
  const amountInput = document.getElementById("amount-input");
  const otpInput = document.getElementById("otp-input");
  const confirmOtpBtn = document.getElementById("confirm-otp");
  const accountItems = document.querySelectorAll(".account-item");

  const tabAmount = document.getElementById("tab-amount");
  const tabOtp = document.getElementById("tab-otp");
  const tabSuccess = document.getElementById("tab-success");

  let isAmountValid = false;

  function showTab(tab) {
    [tabAmount, tabOtp, tabSuccess].forEach(t => t.style.display = "none");
    tab.style.display = "block";
  }

  function validateAmount() {
    const value = parseFloat(amountInput.value);
    isAmountValid = !isNaN(value) && value >= 500;
  }

  function validateOtp() {
    const otp = otpInput.value.trim();
    const isValid = /^\d{6}$/.test(otp);
    confirmOtpBtn.disabled = !isValid;
    otpInput.classList.toggle("is-invalid", !isValid && otp.length > 0);
  }

  amountInput.addEventListener("input", validateAmount);
  otpInput.addEventListener("input", validateOtp);

  accountItems.forEach(item => {
    item.addEventListener("click", (e) => {
      e.preventDefault();
      validateAmount();

      if (!isAmountValid) {
        amountInput.classList.add("is-invalid");
        amountInput.focus();
        return;
      }

      // Clear selection from others
      accountItems.forEach(i => i.classList.remove("selected"));
      item.classList.add("selected");

      showTab(tabOtp);
    });
  });

  confirmOtpBtn.addEventListener("click", () => {
    showTab(tabSuccess);
  });

  // Initialize
  validateAmount();
  validateOtp();
  showTab(tabAmount);
</script>